#include <iostream>
#include <string>
#include <vector>
using namespace std;

// ---------------- MENU ITEM CLASS ----------------
class MenuItem {
public:
    string name;
    int price;

    MenuItem(string n = "", int p = 0) {
        name = n;
        price = p;
    }
};

// ---------------- CART ITEM CLASS ----------------
class CartItem {
public:
    MenuItem item;
    int qty;

    CartItem(MenuItem m, int q) {
        item = m;
        qty = q;
    }
};

// ----------- GLOBAL VARIABLES -----------
vector<MenuItem> menu;
vector<CartItem> cart;

string savedName = "", savedEmail = "", savedMobile = "", savedPassword = "";
string savedType = "Regular";
bool isPrime = false;

int primeDiscount = 10;
string restaurantName = "My Restaurant";


// ---------------- ADMIN LOGIN ----------------
bool adminLogin() {
    string u, p;
    cout << "Admin Username: ";
    cin >> u;
    cout << "Admin Password: ";
    cin >> p;
    return (u == "Rohit" && p == "1234");
}

// ---------------- EDIT MENU ----------------
void editMenu() {
    cout << "\n--- EDIT MENU ITEMS ---\n";

    for (int i = 0; i < menu.size(); i++) {
        cout << i + 1 << ". " << menu[i].name << " - Rs." << menu[i].price << endl;
    }

    int itemNo;
    cout << "Enter Item Number to Edit: ";
    cin >> itemNo;

    if (itemNo < 1 || itemNo > menu.size()) {
        cout << "Invalid Item Number!\n";
        return;
    }

    int choice;
    cout << "\n1. Edit Item Name\n2. Edit Item Price\nEnter Choice: ";
    cin >> choice;

    if (choice == 1) {
        cout << "Enter New Name: ";
        cin >> menu[itemNo - 1].name;
        cout << "Item Name Updated Successfully!\n";
    }
    else if (choice == 2) {
        cout << "Enter New Price: ";
        cin >> menu[itemNo - 1].price;
        cout << "Item Price Updated Successfully!\n";
    }
    else {
        cout << "Invalid Choice!\n";
    }
}

// ---------------- ADMIN MENU ----------------
void adminMenu() {
    int ch;
    while (true) {
        cout << "\n--- Admin Menu ---\n";
        cout << "1. Edit Menu Items\n";
        cout << "2. Edit Prime Discount\n";
        cout << "3. Edit Restaurant Name\n";
        cout << "4. Reset Customer Data\n";
        cout << "5. Exit Admin\n";
        cout << "Enter Choice: ";
        cin >> ch;

        if (ch == 1) editMenu();
        else if (ch == 2) {
            cout << "Enter new Prime Discount (%): ";
            cin >> primeDiscount;
        }
        else if (ch == 3) {
            cout << "Enter new Restaurant Name: ";
            cin >> restaurantName;
        }
        else if (ch == 4) {
            savedName = savedEmail = savedMobile = savedPassword = "";
            savedType = "Regular";
            cout << "All Customer Data Reset.\n";
        }
        else if (ch == 5) break;
        else cout << "Invalid Choice.\n";
    }
}


// ---------------- CUSTOMER REGISTER ----------------
void customerRegister() {
    cout << "\n--- Customer Registration ---\n";

    cout << "Enter Name: ";
    cin >> savedName;

    cout << "Enter Email: ";
    cin >> savedEmail;

    cout << "Enter Mobile No: ";
    cin >> savedMobile;

    cout << "Set Password: ";
    cin >> savedPassword;

    int t;
    cout << "Select Customer Type:\n1. Regular\n2. Prime\nChoice: ";
    cin >> t;

    if (t == 2) {
        cout << "Prime Membership Fee: Rs. 500\n";
        savedType = "Prime";
    }
    else savedType = "Regular";

    cout << "\nCustomer Registration Successful!\n";
}

// ---------------- CUSTOMER LOGIN ----------------
bool customerLogin() {
    if (savedPassword == "") {
        cout << "No Customer Registered Yet. Please Register First.\n";
        return false;
    }

    string email, pass;
    cout << "Enter Email: ";
    cin >> email;
    cout << "Enter Password: ";
    cin >> pass;

    if (email == savedEmail && pass == savedPassword) {
        cout << "\nLogin Successful! Welcome " << savedName << "\n";
        isPrime = (savedType == "Prime");
        return true;
    }

    cout << "Invalid Email/Password.\n";
    return false;
}

// ---------------- ADD TO CART ----------------
void addToCart() {
    int itemChoice, qty;

    cout << "\n--- ADD ITEMS TO CART ---\n";

    for (int i = 0; i < menu.size(); i++) {
        cout << i + 1 << ". " << menu[i].name << " - Rs." << menu[i].price << "\n";
    }

    cout << "Enter Item Number (0 to Stop): ";
    cin >> itemChoice;

    if (itemChoice == 0) return;

    if (itemChoice < 1 || itemChoice > menu.size()) {
        cout << "Invalid Item!\n";
        return;
    }

    cout << "Enter Quantity: ";
    cin >> qty;

    cart.push_back(CartItem(menu[itemChoice - 1], qty));
    cout << "Item Added to Cart!\n";
}

// ---------------- VIEW CART ----------------
void viewCart() {
    cout << "\n----- CART -----\n";

    if (cart.empty()) {
        cout << "Cart is Empty!\n";
        return;
    }

    for (int i = 0; i < cart.size(); i++) {
        cout << cart[i].item.name << " x " << cart[i].qty
             << " = Rs." << cart[i].item.price * cart[i].qty << endl;
    }
}

// ---------------- BILL GENERATION ----------------
void generateBill() {
    if (cart.empty()) {
        cout << "Cart is Empty! Add items first.\n";
        return;
    }

    float total = 0;

    cout << "\n----- FINAL BILL -----\n";
    for (int i = 0; i < cart.size(); i++) {
        int itemTotal = cart[i].item.price * cart[i].qty;
        total += itemTotal;
        cout << cart[i].item.name << " x " << cart[i].qty
             << " = Rs." << itemTotal << endl;
    }

    cout << "------------------------\n";
    cout << "Total Amount: Rs. " << total << endl;

    if (isPrime) {
        float disc = total * (primeDiscount / 100.0);
        total -= disc;
        cout << "Prime Discount (" << primeDiscount << "%): -" << disc << endl;
    }

    cout << "Final Payable Amount: Rs. " << total << endl;
}


// ---------------- MAIN FUNCTION ----------------
int main() {

    // Default fixed menu
    menu.push_back(MenuItem("Pizza", 250));
    menu.push_back(MenuItem("Burger", 120));
    menu.push_back(MenuItem("Sandwich", 150));
    menu.push_back(MenuItem("Pasta", 180));
    menu.push_back(MenuItem("Cold Drink", 60));

    int choice;

    while (true) {
        cout << "\n===== MAIN MENU =====\n";
        cout << "1. Admin Login\n";
        cout << "2. Customer Register\n";
        cout << "3. Customer Login\n";
        cout << "4. Exit\n";
        cout << "Enter Choice: ";
        cin >> choice;

        if (choice == 1) {
            if (adminLogin()) {
                cout << "Admin Login Successful.\n";
                adminMenu();
            } else cout << "Invalid Admin Credentials.\n";
        }

        else if (choice == 2) customerRegister();

        else if (choice == 3) {

            if (customerLogin()) {

                int ch;
                while (true) {
                    cout << "\n--- CUSTOMER PANEL ---\n";
                    cout << "1. Add Item to Cart\n";
                    cout << "2. View Cart\n";
                    cout << "3. Generate Bill\n";
                    cout << "4. Logout\n";
                    cout << "Enter Choice: ";
                    cin >> ch;

                    if (ch == 1) addToCart();
                    else if (ch == 2) viewCart();
                    else if (ch == 3) generateBill();
                    else if (ch == 4) break;
                    else cout << "Invalid Choice!\n";
                }

            }
        }

        else if (choice == 4) {
            cout << "Thank you for using the system!\n";
            break;
        }

        else cout << "Invalid Choice!\n";
    }

    return 0;
}
